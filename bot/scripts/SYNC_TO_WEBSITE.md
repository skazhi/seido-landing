# üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–∞–π—Ç seidorun.ru

## –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç `sync_to_mysql.py` —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π SQLite –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (bot/seido.db) –≤ MySQL –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ –¥–ª—è —Å–∞–π—Ç–∞ seidorun.ru.

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
cd bot
pip install pymysql
```

–ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `bot/scripts/sync_to_mysql.py` –∏ –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ MySQL:

```python
MYSQL_CONFIG = {
    'host': 'localhost',  # –∏–ª–∏ IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞
    'user': 'u3426357_Skazhi',  # –í–∞—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å MySQL
    'password': 'fS9eO6gL2rbB5uM5',  # –í–∞—à –ø–∞—Ä–æ–ª—å MySQL
    'database': 'u3426357_seido',  # –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    'charset': 'utf8mb4',
    'autocommit': False
}
```

### 3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ MySQL –±–∞–∑–∞ —Å–æ–∑–¥–∞–Ω–∞

–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```bash
mysql -u u3426357_Skazhi -p u3426357_seido < database/seido_mysql.sql
```

–ò–ª–∏ —á–µ—Ä–µ–∑ phpMyAdmin –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª `database/seido_mysql.sql`.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

```bash
cd bot/scripts
python sync_to_mysql.py
```

### –ß—Ç–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è

1. **–ë–µ–≥—É–Ω—ã (runners)** - –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ—Ç–∞
2. **–ó–∞–±–µ–≥–∏ (races)** - –≤—Å–µ –∑–∞–±–µ–≥–∏ –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
3. **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã (results)** - –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –±–µ–≥—É–Ω–æ–≤

### –õ–æ–≥–∏–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

- –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (–ø–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –ø–æ–ª—è–º) - –æ–Ω–∞ **–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è**
- –ï—Å–ª–∏ –∑–∞–ø–∏—Å–∏ –Ω–µ—Ç - –æ–Ω–∞ **–¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è**
- –û—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è, –Ω–æ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –ø—Ä–æ—Ü–µ—Å—Å

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: Cron (Linux/Mac)

–î–æ–±–∞–≤—å—Ç–µ –≤ crontab:
```bash
# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–∂–¥—ã–π —á–∞—Å
0 * * * * cd /path/to/Seido/bot/scripts && python sync_to_mysql.py >> /var/log/seido_sync.log 2>&1
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á Windows

1. –û—Ç–∫—Ä–æ–π—Ç–µ "–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á"
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É
3. –¢—Ä–∏–≥–≥–µ—Ä: –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∂–¥—ã–π —á–∞—Å)
4. –î–µ–π—Å—Ç–≤–∏–µ: –∑–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã
   - –ü—Ä–æ–≥—Ä–∞–º–º–∞: `python`
   - –ê—Ä–≥—É–º–µ–Ω—Ç—ã: `C:\Users\PC User\Documents\Seido\bot\scripts\sync_to_mysql.py`
   - –†–∞–±–æ—á–∞—è –ø–∞–ø–∫–∞: `C:\Users\PC User\Documents\Seido\bot\scripts`

### –í–∞—Ä–∏–∞–Ω—Ç 3: –í –∫–æ–¥–µ –±–æ—Ç–∞

–î–æ–±–∞–≤—å—Ç–µ –≤ `bot/main.py` –ø–æ—Å–ª–µ –ø–∞—Ä—Å–∏–Ω–≥–∞:

```python
# –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —Å–∞–π—Ç–æ–º (—Ä–∞–∑ –≤ —á–∞—Å)
async def _sync_to_website():
    while True:
        try:
            from scripts.sync_to_mysql import main as sync_main
            await sync_main()
        except Exception as e:
            logging.error(f"–û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å —Å–∞–π—Ç–æ–º: {e}")
        await asyncio.sleep(3600)  # 1 —á–∞—Å

asyncio.create_task(_sync_to_website())
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

–ü–æ—Å–ª–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ API:

```bash
# –ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ –∑–∞–±–µ–≥–∏
curl http://seidorun.ru/api/api.php?action=races_upcoming

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±–µ–≥—É–Ω–∞
curl http://seidorun.ru/api/api.php?action=runner_results&telegram_id=123456789
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MySQL

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –≤ `MYSQL_CONFIG`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ MySQL —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –û—à–∏–±–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü —Å–æ–≤–ø–∞–¥–∞–µ—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–¥–∏—Ä–æ–≤–∫—É (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å utf8mb4)

### –î–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ API —Ä–∞–±–æ—Ç–∞–µ—Ç: `http://seidorun.ru/api/api.php`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–ª–∏—Å—å (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ MySQL)

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Ñ–∞–π–ª `sync_to_mysql.py` —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø–∞—Ä–æ–ª—è–º–∏ –≤ Git!

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```python
import os
MYSQL_CONFIG = {
    'host': os.getenv('MYSQL_HOST', 'localhost'),
    'user': os.getenv('MYSQL_USER'),
    'password': os.getenv('MYSQL_PASSWORD'),
    'database': os.getenv('MYSQL_DATABASE'),
    'charset': 'utf8mb4',
    'autocommit': False
}
```

–ò —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:
```
MYSQL_HOST=localhost
MYSQL_USER=u3426357_Skazhi
MYSQL_PASSWORD=your_password
MYSQL_DATABASE=u3426357_seido
```
